<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GuestFind - Premium Lost & Found System</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- SweetAlert2 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <style>
        :root {
            --navy-blue: #0a192f;
            --navy-light: #112240;
            --gold: #d4af37;
            --gold-light: #f1e5ac;
            --white: #ffffff;
            --off-white: #f8f9fa;
            --text-dark: #333333;
            --text-light: #e6f1ff;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        body {
            background-color: var(--off-white);
            color: var(--text-dark);
            font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .navbar {
            background-color: var(--navy-blue);
            box-shadow: var(--shadow);
            padding: 0.8rem 0;
        }

        .navbar-brand {
            color: var(--gold) !important;
            font-weight: 700;
            font-size: 1.5rem;
        }

        .navbar-nav .nav-link {
            color: var(--text-light) !important;
            font-weight: 500;
            padding: 0.5rem 1rem;
            transition: var(--transition);
        }

        .navbar-nav .nav-link:hover {
            color: var(--gold) !important;
        }

        .navbar-nav .nav-link.active {
            color: var(--gold) !important;
            border-bottom: 2px solid var(--gold);
        }

        .btn-primary {
            background-color: var(--gold);
            border-color: var(--gold);
            color: var(--navy-blue);
            font-weight: 600;
            transition: var(--transition);
        }

        .btn-primary:hover {
            background-color: var(--navy-blue);
            border-color: var(--navy-blue);
            color: var(--gold);
            transform: translateY(-2px);
        }

        .btn-outline-primary {
            border-color: var(--gold);
            color: var(--gold);
            font-weight: 600;
            transition: var(--transition);
        }

        .btn-outline-primary:hover {
            background-color: var(--gold);
            color: var(--navy-blue);
            transform: translateY(-2px);
        }

        .hero-section {
            background: linear-gradient(rgba(10, 25, 47, 0.9), rgba(10, 25, 47, 0.85)), url('https://images.unsplash.com/photo-1566073771259-6a8506099945?ixlib=rb-4.0.3&auto=format&fit=crop&w=1600&q=80');
            background-size: cover;
            background-position: center;
            color: var(--text-light);
            padding: 6rem 0;
            position: relative;
        }

        .hero-section::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100px;
            background: linear-gradient(to top, var(--off-white), transparent);
        }

        .feature-card {
            border: none;
            border-radius: 15px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            height: 100%;
            background: var(--white);
            overflow: hidden;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }

        .feature-icon {
            font-size: 2.8rem;
            color: var(--gold);
            margin-bottom: 1.5rem;
            transition: var(--transition);
        }

        .feature-card:hover .feature-icon {
            transform: scale(1.1);
        }

        .stat-card {
            background: linear-gradient(135deg, var(--navy-blue), var(--navy-light));
            border-radius: 15px;
            box-shadow: var(--shadow);
            text-align: center;
            padding: 2rem;
            color: var(--text-light);
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 2.8rem;
            font-weight: 700;
            color: var(--gold);
            margin-bottom: 0.5rem;
        }

        .status-badge {
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-matched {
            background: #d4edda;
            color: #155724;
        }

        .status-closed {
            background: #f8d7da;
            color: #721c24;
        }

        .status-unclaimed {
            background: #e2e3e5;
            color: #383d41;
        }

        .status-claimed {
            background: #cce7ff;
            color: #004085;
        }

        .dashboard-section {
            background: var(--white);
            border-radius: 15px;
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-bottom: 2.5rem;
            transition: var(--transition);
        }

        .dashboard-section:hover {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        footer {
            background-color: var(--navy-blue);
            color: var(--text-light);
            padding: 4rem 0 2rem;
        }

        .section-title {
            position: relative;
            display: inline-block;
            margin-bottom: 2.5rem;
            font-weight: 700;
            color: var(--navy-blue);
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -15px;
            left: 0;
            width: 70px;
            height: 4px;
            background-color: var(--gold);
            border-radius: 2px;
        }

        .card-title {
            color: var(--navy-blue);
            font-weight: 600;
        }

        .modal-content {
            border-radius: 15px;
            border: none;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .modal-header {
            border-bottom: 2px solid var(--gold);
            background-color: var(--navy-blue);
            color: var(--white);
            padding: 1.2rem 1.5rem;
        }

        .modal-header .btn-close {
            filter: invert(1);
            opacity: 0.8;
            transition: var(--transition);
        }

        .modal-header .btn-close:hover {
            opacity: 1;
            transform: rotate(90deg);
        }

        .form-control:focus {
            border-color: var(--gold);
            box-shadow: 0 0 0 0.25rem rgba(212, 175, 55, 0.25);
        }

        .notification-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: var(--danger);
            color: white;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .profile-card {
            background: var(--white);
            border-radius: 15px;
            box-shadow: var(--shadow);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .profile-header {
            display: flex;
            align-items: center;
            margin-bottom: 2rem;
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: var(--navy-blue);
            color: var(--gold);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            margin-right: 1.5rem;
        }

        .action-btn {
            transition: var(--transition);
        }

        .action-btn:hover {
            transform: translateY(-3px);
        }

        .nav-pills .nav-link.active {
            background-color: var(--gold);
            color: var(--navy-blue);
            font-weight: 600;
        }

        .nav-pills .nav-link {
            color: var(--navy-blue);
            font-weight: 500;
        }

        .table-hover tbody tr:hover {
            background-color: rgba(212, 175, 55, 0.1);
        }

        .claim-proof {
            border: 2px dashed #dee2e6;
            border-radius: 10px;
            padding: 1.5rem;
            text-align: center;
            margin: 1rem 0;
            cursor: pointer;
            transition: var(--transition);
        }

        .claim-proof:hover {
            border-color: var(--gold);
            background-color: rgba(212, 175, 55, 0.05);
        }

        .admin-panel {
            background: linear-gradient(135deg, var(--navy-light), var(--navy-blue));
            border-radius: 15px;
            padding: 2rem;
            color: var(--text-light);
            margin-bottom: 2rem;
        }

        .admin-panel h3 {
            color: var(--gold);
            margin-bottom: 1.5rem;
        }

        @media (max-width: 768px) {
            .hero-section {
                padding: 4rem 0;
            }

            .profile-header {
                flex-direction: column;
                text-align: center;
            }

            .profile-avatar {
                margin-right: 0;
                margin-bottom: 1rem;
            }
        }
    </style>
</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-dark sticky-top">
    <div class="container">
        <a class="navbar-brand" href="#">
            <i class="fas fa-key me-2"></i>GuestFind
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav me-auto">
                <li class="nav-item">
                    <a class="nav-link active" href="#" id="homeLink">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#howItWorksModal">How It Works</a>
                </li>
                <li class="nav-item d-none" id="dashboardNavItem">
                    <a class="nav-link" href="#" id="dashboardLink">Dashboard</a>
                </li>
                <li class="nav-item d-none" id="adminNavItem">
                    <a class="nav-link" href="#" id="adminLink">Admin Panel</a>
                </li>
            </ul>
            <div class="d-flex" id="authButtons">
                <button class="btn btn-outline-light me-2" data-bs-toggle="modal" data-bs-target="#loginModal">Login</button>
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#registerModal">Register</button>
            </div>
            <div class="d-none" id="userMenu">
                <div class="dropdown">
                    <button class="btn btn-outline-light dropdown-toggle position-relative" type="button" id="userDropdown" data-bs-toggle="dropdown">
                        <i class="fas fa-user me-1"></i> <span id="username">User</span>
                        <span class="notification-badge d-none" id="notificationsBadge">0</span>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="#" id="profileLink"><i class="fas fa-user-circle me-2"></i>Profile</a></li>
                        <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#notificationsModal"><i class="fas fa-bell me-2"></i>Notifications</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="#" id="logoutBtn"><i class="fas fa-sign-out-alt me-2"></i>Logout</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>

<!-- Hero Section -->
<section class="hero-section">
    <div class="container text-center">
        <h1 class="display-3 fw-bold mb-4">Premium Lost & Found System for Hotels</h1>
        <p class="lead mb-4">Revolutionizing how hotels and guests manage lost items with our sophisticated tracking and matching system.</p>
        <div class="d-flex justify-content-center gap-3 flex-wrap">
            <button class="btn btn-primary btn-lg action-btn" data-bs-toggle="modal" data-bs-target="#reportModal"><i class="fas fa-plus-circle me-2"></i>Report Lost Item</button>
            <button class="btn btn-outline-light btn-lg action-btn" data-bs-toggle="modal" data-bs-target="#foundModal"><i class="fas fa-search me-2"></i>Report Found Item</button>
        </div>
    </div>
</section>

<!-- Features Section -->
<section class="py-5">
    <div class="container">
        <h2 class="text-center section-title mb-5">How GuestFind Works</h2>
        <div class="row g-4">
            <div class="col-md-4">
                <div class="card feature-card h-100">
                    <div class="card-body text-center p-4">
                        <div class="feature-icon mb-3">
                            <i class="fas fa-search"></i>
                        </div>
                        <h3 class="card-title">Report Items</h3>
                        <p class="card-text">Guests can easily report lost items with detailed descriptions and images for better identification.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card feature-card h-100">
                    <div class="card-body text-center p-4">
                        <div class="feature-icon mb-3">
                            <i class="fas fa-bell"></i>
                        </div>
                        <h3 class="card-title">Get Notified</h3>
                        <p class="card-text">Receive instant notifications via email or SMS when your lost item is found or matched.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card feature-card h-100">
                    <div class="card-body text-center p-4">
                        <div class="feature-icon mb-3">
                            <i class="fas fa-shipping-fast"></i>
                        </div>
                        <h3 class="card-title">Delivery Options</h3>
                        <p class="card-text">Choose to pick up your item in person or request delivery to your address.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Dashboard Section (Initially Hidden) -->
<section class="py-5 d-none" id="dashboardSection">
    <div class="container">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2 class="section-title" id="dashboardTitle">Dashboard</h2>
            <div>
                <button class="btn btn-primary me-2 d-none" id="addItemBtn" data-bs-toggle="modal" data-bs-target="#foundModal"><i class="fas fa-plus me-2"></i>Add Found Item</button>
                <button class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#reportModal"><i class="fas fa-plus me-2"></i>Report Lost Item</button>
            </div>
        </div>

        <div class="row g-4 mb-4" id="statsSection">
            <!-- Stats will be loaded here dynamically -->
        </div>

        <!-- Profile Section -->
        <div class="dashboard-section d-none" id="profileSection">
            <div class="profile-header">
                <div class="profile-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <div>
                    <h3 id="profileUserName">User Name</h3>
                    <p class="text-muted" id="profileUserRole">Role</p>
                    <p class="text-muted" id="profileUserEmail">email@example.com</p>
                </div>
            </div>

            <ul class="nav nav-pills mb-3" id="profileTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="profile-tab" data-bs-toggle="pill" data-bs-target="#profile" type="button" role="tab">Profile</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="security-tab" data-bs-toggle="pill" data-bs-target="#security" type="button" role="tab">Security</button>
                </li>
            </ul>

            <div class="tab-content" id="profileTabsContent">
                <div class="tab-pane fade show active" id="profile" role="tabpanel">
                    <form id="profileForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="profileName" class="form-label">Full Name</label>
                                    <input type="text" class="form-control" id="profileName">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="profileEmail" class="form-label">Email Address</label>
                                    <input type="email" class="form-control" id="profileEmail" disabled>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="profilePhone" class="form-label">Phone Number</label>
                                    <input type="tel" class="form-control" id="profilePhone">
                                </div>
                            </div>
                            <div class="col-12">
                                <button type="submit" class="btn btn-primary">Update Profile</button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="tab-pane fade" id="security" role="tabpanel">
                    <form id="securityForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="currentPassword" class="form-label">Current Password</label>
                                    <input type="password" class="form-control" id="currentPassword">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="newPassword" class="form-label">New Password</label>
                                    <input type="password" class="form-control" id="newPassword">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="confirmPassword" class="form-label">Confirm New Password</label>
                                    <input type="password" class="form-control" id="confirmPassword">
                                </div>
                            </div>
                            <div class="col-12">
                                <button type="submit" class="btn btn-primary">Update Password</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Admin Panel Section -->
        <div class="admin-panel d-none" id="adminPanelSection">
            <h3><i class="fas fa-cog me-2"></i>Admin Management Panel</h3>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <div class="card h-100">
                        <div class="card-body text-center">
                            <i class="fas fa-hotel fa-3x text-primary mb-3"></i>
                            <h5 class="card-title">Hotel Management</h5>
                            <p class="card-text">Add and manage hotels in the system</p>
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#manageHotelsModal">Manage Hotels</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-3">
                    <div class="card h-100">
                        <div class="card-body text-center">
                            <i class="fas fa-users fa-3x text-primary mb-3"></i>
                            <h5 class="card-title">Staff Management</h5>
                            <p class="card-text">Register and manage staff accounts</p>
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#manageStaffModal">Manage Staff</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-3">
                    <div class="card h-100">
                        <div class="card-body text-center">
                            <i class="fas fa-archive fa-3x text-primary mb-3"></i>
                            <h5 class="card-title">Archived Items</h5>
                            <p class="card-text">View and manage archived items</p>
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#archivedItemsModal">View Archive</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="dashboard-section">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h3>Lost Items</h3>
                <div class="btn-group" role="group">
                    <button type="button" class="btn btn-outline-primary active" data-filter="all">All</button>
                    <button type="button" class="btn btn-outline-primary" data-filter="pending">Pending</button>
                    <button type="button" class="btn btn-outline-primary" data-filter="matched">Matched</button>
                </div>
            </div>
            <div class="table-responsive">
                <table class="table table-hover" id="lostItemsTable">
                    <thead>
                    <tr>
                        <th>Item</th>
                        <th>Guest</th>
                        <th>Date Reported</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                    </thead>
                    <tbody>
                    <!-- Lost items will be loaded here dynamically -->
                    </tbody>
                </table>
            </div>
        </div>

        <div class="dashboard-section">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h3>Found Items</h3>
                <div class="btn-group" role="group">
                    <button type="button" class="btn btn-outline-primary active" data-filter="all">All</button>
                    <button type="button" class="btn btn-outline-primary" data-filter="unclaimed">Unclaimed</button>
                    <button type="button" class="btn btn-outline-primary" data-filter="matched">Matched</button>
                </div>
            </div>
            <div class="table-responsive">
                <table class="table table-hover" id="foundItemsTable">
                    <thead>
                    <tr>
                        <th>Item</th>
                        <th>Found By</th>
                        <th>Date Found</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                    </thead>
                    <tbody>
                    <!-- Found items will be loaded here dynamically -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Claim Requests Section (Admin Only) -->
        <div class="dashboard-section d-none" id="claimRequestsSection">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h3>Claim Requests</h3>
                <span class="badge bg-primary" id="claimRequestsCount">0</span>
            </div>
            <div class="table-responsive">
                <table class="table table-hover" id="claimRequestsTable">
                    <thead>
                    <tr>
                        <th>Item</th>
                        <th>Claimant</th>
                        <th>Date Claimed</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                    </thead>
                    <tbody>
                    <!-- Claim requests will be loaded here dynamically -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</section>

<!-- Footer -->
<footer class="py-5 mt-5">
    <div class="container">
        <div class="row">
            <div class="col-lg-4 mb-4">
                <h5 class="text-warning">About GuestFind</h5>
                <p>GuestFind is a sophisticated lost and found system designed specifically for hotels and their guests, streamlining the process of reporting, matching, and returning lost items.</p>
            </div>
            <div class="col-lg-4 mb-4">
                <h5 class="text-warning">Quick Links</h5>
                <ul class="list-unstyled">
                    <li><a href="#" class="text-light text-decoration-none">Home</a></li>
                    <li><a href="#" class="text-light text-decoration-none" data-bs-toggle="modal" data-bs-target="#howItWorksModal">How It Works</a></li>
                    <li><a href="#" class="text-light text-decoration-none" data-bs-toggle="modal" data-bs-target="#reportModal">Report Lost Item</a></li>
                    <li><a href="#" class="text-light text-decoration-none" data-bs-toggle="modal" data-bs-target="#foundModal">Report Found Item</a></li>
                </ul>
            </div>
            <div class="col-lg-4 mb-4">
                <h5 class="text-warning">Contact Information</h5>
                <ul class="list-unstyled">
                    <li><i class="fas fa-map-marker-alt me-2"></i> 159/2c Kurunduwatta, Meegoda, Sri Lanka</li>
                    <li><i class="fas fa-phone me-2"></i> +94 11 275 0429</li>
                    <li><i class="fas fa-envelope me-2"></i> support@guestfind.com</li>
                </ul>
            </div>
        </div>
        <hr class="bg-light">
        <div class="text-center">
            <p class="mb-0">&copy; 2025 GuestFind. All rights reserved.</p>
        </div>
    </div>
</footer>

<!-- Modals -->
<!-- Login Modal -->
<div class="modal fade" id="loginModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Login to Your Account</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="loginForm">
                    <div class="mb-3">
                        <label for="loginEmail" class="form-label">Email Address</label>
                        <input type="email" class="form-control" id="loginEmail" required>
                    </div>
                    <div class="mb-3">
                        <label for="loginPassword" class="form-label">Password</label>
                        <input type="password" class="form-control" id="loginPassword" required>
                    </div>
                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" id="userTypeCheck">
                        <label class="form-check-label" for="userTypeCheck">I am a hotel staff member</label>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">Login</button>
                </form>
                <div class="text-center mt-3">
                    <p>Don't have an account? <a href="#" data-bs-toggle="modal" data-bs-target="#registerModal" data-bs-dismiss="modal">Register</a></p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Register Modal -->
<div class="modal fade" id="registerModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Create an Account</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="registerForm">
                    <div class="mb-3">
                        <label for="registerName" class="form-label">Full Name</label>
                        <input type="text" class="form-control" id="registerName" required>
                    </div>
                    <div class="mb-3">
                        <label for="registerEmail" class="form-label">Email Address</label>
                        <input type="email" class="form-control" id="registerEmail" required>
                    </div>
                    <div class="mb-3">
                        <label for="registerPhone" class="form-label">Phone Number (Optional)</label>
                        <input type="tel" class="form-control" id="registerPhone">
                    </div>
                    <div class="mb-3">
                        <label for="registerPassword" class="form-label">Password</label>
                        <input type="password" class="form-control" id="registerPassword" required>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">Register</button>
                </form>
                <div class="text-center mt-3">
                    <p>Already have an account? <a href="#" data-bs-toggle="modal" data-bs-target="#loginModal" data-bs-dismiss="modal">Login</a></p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Report Lost Item Modal -->
<div class="modal fade" id="reportModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Report a Lost Item</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="reportForm">
                    <div class="mb-3">
                        <label for="itemName" class="form-label">Item Name</label>
                        <input type="text" class="form-control" id="itemName" required>
                    </div>
                    <div class="mb-3">
                        <label for="itemDescription" class="form-label">Description</label>
                        <textarea class="form-control" id="itemDescription" rows="3" required></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="lostDate" class="form-label">Date Lost</label>
                        <input type="date" class="form-control" id="lostDate" required>
                    </div>
                    <div class="mb-3">
                        <label for="lostLocation" class="form-label">Location Lost</label>
                        <input type="text" class="form-control" id="lostLocation" required>
                    </div>
<!--                    <div class="mb-3">-->
<!--                        <label for="itemImage" class="form-label">Upload Image (Optional)</label>-->
<!--                        <input type="file" class="form-control" id="itemImage">-->
<!--                    </div>-->
                    <div class="mb-3">
                        <label for="lostItemImage" class="form-label">Upload Image (optional)</label>
                        <input type="file" class="form-control" id="lostItemImage" accept="image/*">
                    </div>
                    <button type="submit" class="btn btn-primary w-100">Submit Report</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Report Found Item Modal -->
<div class="modal fade" id="foundModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Report a Found Item</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="foundForm">
                    <div class="mb-3">
                        <label for="foundItemName" class="form-label">Item Name</label>
                        <input type="text" class="form-control" id="foundItemName" required>
                    </div>
                    <div class="mb-3">
                        <label for="foundItemDescription" class="form-label">Description</label>
                        <textarea class="form-control" id="foundItemDescription" rows="3" required></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="foundDate" class="form-label">Date Found</label>
                        <input type="date" class="form-control" id="foundDate" required>
                    </div>
                    <div class="mb-3">
                        <label for="foundLocation" class="form-label">Location Found</label>
                        <input type="text" class="form-control" id="foundLocation" required>
                    </div>
<!--                    <div class="mb-3">-->
<!--                        <label for="foundItemImage" class="form-label">Upload Image (Optional)</label>-->
<!--                        <input type="file" class="form-control" id="foundItemImage">-->
<!--                    </div>-->
                    <div class="mb-3">
                        <label for="foundItemImage" class="form-label">Upload Image (optional)</label>
                        <input type="file" class="form-control" id="foundItemImage" accept="image/*">
                    </div>

                    <button type="submit" class="btn btn-primary w-100">Submit Found Item</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Claim Item Modal -->
<div class="modal fade" id="claimItemModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Claim Found Item</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="claimForm">
                    <input type="hidden" id="claimItemId">
                    <div class="mb-3">
                        <label class="form-label">Item to Claim</label>
                        <p class="form-control-static fw-bold" id="claimItemName"></p>
                    </div>
                    <div class="mb-3">
                        <label for="claimMessage" class="form-label">Message to Admin</label>
                        <textarea class="form-control" id="claimMessage" rows="3" required placeholder="Please provide details why you believe this is your item"></textarea>
                    </div>
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Upload Proof (Optional)</label>-->
<!--                        <div class="claim-proof" id="proofUploadArea">-->
<!--                            <i class="fas fa-cloud-upload-alt fa-2x mb-2"></i>-->
<!--                            <p>Click to upload proof images</p>-->
<!--                            <input type="file" class="d-none" id="claimProof">-->
<!--                        </div>-->
<!--                        <div id="proofPreview" class="mt-2"></div>-->
<!--                    </div>-->
                    <div class="mb-3">
                        <label for="claimProof" class="form-label">Proof of Ownership (optional)</label>
                        <input type="file" class="form-control" id="claimProof" accept="image/*">
                        <div id="proofPreview" class="mt-2"></div>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">Submit Claim</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Notifications Modal -->
<div class="modal fade" id="notificationsModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Your Notifications</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div id="notificationsList">
                    <div class="text-center py-4" id="notificationsLoading">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p class="mt-2">Loading notifications...</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="markAllAsReadBtn">Mark All as Read</button>
            </div>
        </div>
    </div>
</div>

<!-- How It Works Modal -->
<div class="modal fade" id="howItWorksModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">How GuestFind Works</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <h4>For Guests</h4>
                        <ol>
                            <li>Report lost items with detailed descriptions</li>
                            <li>Upload images for better identification</li>
                            <li>Get notified when your item is found</li>
                            <li>Track item status via email/SMS</li>
                            <li>Choose to collect in person or request delivery</li>
                        </ol>
                    </div>
                    <div class="col-md-6">
                        <h4>For Hotel Staff</h4>
                        <ol>
                            <li>Login to manage found item inventory</li>
                            <li>Add item details with images</li>
                            <li>Search guest reports and match found items</li>
                            <li>Notify guests with update links</li>
                            <li>Track unclaimed items and decide actions</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Admin Modals -->
<div class="modal fade" id="manageHotelsModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Manage Hotels</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <button class="btn btn-primary mb-3" id="addHotelBtn"><i class="fas fa-plus me-2"></i>Add New Hotel</button>
                <div class="table-responsive">
                    <table class="table table-hover" id="hotelsTable">
                        <thead>
                        <tr>
                            <th>Hotel Name</th>
                            <th>Address</th>
                            <th>Phone</th>
                            <th>Actions</th>
                        </tr>
                        </thead>
                        <tbody>
                        <!-- Hotels will be loaded here dynamically -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="manageStaffModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Manage Staff</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <button class="btn btn-primary mb-3" id="addStaffBtn"><i class="fas fa-plus me-2"></i>Add New Staff</button>
                <div class="table-responsive">
                    <table class="table table-hover" id="staffTable">
                        <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Role</th>
                            <th>Hotel</th>
                            <th>Actions</th>
                        </tr>
                        </thead>
                        <tbody>
                        <!-- Staff will be loaded here dynamically -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="itemDetailsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Item Details</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <!-- Filled dynamically -->
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="claimDetailsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Claim Details</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <!-- Filled dynamically -->
            </div>
        </div>
    </div>
</div>

<!-- Bootstrap JS and dependencies -->
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<!-- SweetAlert2 -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.all.min.js"></script>

<script>
    // Base URL for API - adjust according to your backend
    const API_BASE_URL = 'http://localhost:8080';
    let currentUser = null;
    let jwtToken = null;
    let notifications = [];

    // Initialize SweetAlert2
    const Toast = Swal.mixin({
        toast: true,
        position: 'top-end',
        showConfirmButton: false,
        timer: 3000,
        timerProgressBar: true,
        didOpen: (toast) => {
            toast.addEventListener('mouseenter', Swal.stopTimer)
            toast.addEventListener('mouseleave', Swal.resumeTimer)
        }
    });

    // Check if user is already logged in
    $(document).ready(function() {
        const savedToken = localStorage.getItem('jwtToken');
        const savedUser = localStorage.getItem('currentUser');

        if (savedToken && savedUser) {
            jwtToken = savedToken;
            currentUser = JSON.parse(savedUser);
            updateUIAfterLogin();
            loadDashboardData();
        }

        // Login form submission
        $('#loginForm').on('submit', function(e) {
            e.preventDefault();
            loginUser();
        });

        // Register form submission
        $('#registerForm').on('submit', function(e) {
            e.preventDefault();
            registerUser();
        });

        // Report form submission
        $('#reportForm').on('submit', function(e) {
            e.preventDefault();
            reportLostItem();
        });

        // Found item form submission
        $('#foundForm').on('submit', function(e) {
            e.preventDefault();
            reportFoundItem();
        });

        // Profile form submission
        $('#profileForm').on('submit', function(e) {
            e.preventDefault();
            updateProfile();
        });

        // Security form submission
        $('#securityForm').on('submit', function(e) {
            e.preventDefault();
            updatePassword();
        });

        // Claim form submission
        $('#claimForm').on('submit', function(e) {
            e.preventDefault();
            submitClaim();
        });

        // Logout button
        $('#logoutBtn').on('click', function(e) {
            e.preventDefault();
            logoutUser();
        });

        // Notifications modal
        $('#notificationsModal').on('show.bs.modal', function() {
            loadNotifications();
        });

        // Mark all as read button
        $('#markAllAsReadBtn').on('click', function() {
            markAllNotificationsAsRead();
        });

        // Profile link
        $('#profileLink').on('click', function(e) {
            e.preventDefault();
            showProfileSection();
        });

        // Dashboard link
        $('#dashboardLink').on('click', function(e) {
            e.preventDefault();
            showDashboardSection();
        });

        // Admin link
        $('#adminLink').on('click', function(e) {
            e.preventDefault();
            showAdminSection();
        });

        // Home link
        $('#homeLink').on('click', function(e) {
            e.preventDefault();
            showHomeSection();
        });

        // Proof upload area
        $('#proofUploadArea').on('click', function() {
            $('#claimProof').click();
        });

        // Claim proof change
        $('#claimProof').on('change', function(e) {
            handleProofUpload(e);
        });

        // Filter buttons
        $('[data-filter]').on('click', function() {
            const filter = $(this).data('filter');
            $('[data-filter]').removeClass('active');
            $(this).addClass('active');
            filterItems(filter);
        });
    });

    // Show success message
    function showSuccess(message) {
        Toast.fire({
            icon: 'success',
            title: message
        });
    }

    // Show error message
    function showError(message) {
        Toast.fire({
            icon: 'error',
            title: message
        });
    }

    // Show confirmation dialog
    function showConfirm(message, confirmCallback) {
        Swal.fire({
            title: 'Are you sure?',
            text: message,
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#d4af37',
            cancelButtonColor: '#6c757d',
            confirmButtonText: 'Yes, proceed!'
        }).then((result) => {
            if (result.isConfirmed) {
                confirmCallback();
            }
        });
    }

    // Login function
    function loginUser() {
        const email = $('#loginEmail').val();
        const password = $('#loginPassword').val();
        const isStaff = $('#userTypeCheck').is(':checked');

        const endpoint = isStaff ? '/auth/login' : '/auth/guest/login';
        const credentials = isStaff ?
            { email: email, password: password } :
            { email: email, password: password };

        $.ajax({
            url: API_BASE_URL + endpoint,
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(credentials),
            success: function(response) {
                if (response.status === 200) {
                    jwtToken = response.data.token;
                    currentUser = response.data.user;

                    // Store in localStorage
                    localStorage.setItem('jwtToken', jwtToken);
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));

                    // Update UI
                    updateUIAfterLogin();
                    loadDashboardData();

                    // Close modal
                    $('#loginModal').modal('hide');

                    // Show success message
                    showSuccess('Login successful!');
                }
            },
            error: function(xhr) {
                showError('Login failed: ' + (xhr.responseJSON?.message || 'Unknown error'));
            }
        });
    }

    // Register function
    function registerUser() {
        const name = $('#registerName').val();
        const email = $('#registerEmail').val();
        const phone = $('#registerPhone').val();
        const password = $('#registerPassword').val();

        const userData = {
            name: name,
            email: email,
            phone: phone || '',
            password: password
        };

        $.ajax({
            url: API_BASE_URL + '/auth/guest/register',
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(userData),
            success: function(response) {
                if (response.status === 200) {
                    showSuccess('Registration successful! Please login.');
                    $('#registerModal').modal('hide');
                    $('#loginModal').modal('show');
                }
            },
            error: function(xhr) {
                showError('Registration failed: ' + (xhr.responseJSON?.message || 'Unknown error'));
            }
        });
    }

    // // Update profile
    // function updateProfile() {
    //     const name = $('#profileName').val();
    //     const phone = $('#profilePhone').val();
    //
    //     // In a real implementation, you would make an API call to update the profile
    //     showSuccess('Profile updated successfully!');
    // }

    // Update profile
    function updateProfile() {
        const name = $('#profileName').val();
        const phone = $('#profilePhone').val();
        const email = $('#profileEmail').val();

        const profileData = {
            name: name,
            phone: phone
        };

        // Determine endpoint based on user role
        const endpoint = currentUser.role === 'GUEST' ? '/guests/profile' : '/staff/profile';

        $.ajax({
            url: API_BASE_URL + endpoint,
            type: 'PUT',
            contentType: 'application/json',
            headers: {
                'Authorization': 'Bearer ' + jwtToken
            },
            data: JSON.stringify(profileData),
            success: function(response) {
                if (response.status === 200) {
                    // Update current user data
                    currentUser.name = name;
                    currentUser.phone = phone;
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));

                    // Update UI
                    $('#profileUserName').text(name);
                    $('#profileUserEmail').text(email);

                    showSuccess('Profile updated successfully!');
                }
            },
            error: function(xhr) {
                showError('Failed to update profile: ' + (xhr.responseJSON?.message || 'Unknown error'));
            }
        });
    }

    // // Update password
    // function updatePassword() {
    //     const currentPassword = $('#currentPassword').val();
    //     const newPassword = $('#newPassword').val();
    //     const confirmPassword = $('#confirmPassword').val();
    //
    //     if (newPassword !== confirmPassword) {
    //         showError('New passwords do not match!');
    //         return;
    //     }
    //
    //     // In a real implementation, you would make an API call to update the password
    //     showSuccess('Password updated successfully!');
    //     $('#securityForm')[0].reset();
    // }

    // Update password
    function updatePassword() {
        const currentPassword = $('#currentPassword').val();
        const newPassword = $('#newPassword').val();
        const confirmPassword = $('#confirmPassword').val();

        if (newPassword !== confirmPassword) {
            showError('New passwords do not match!');
            return;
        }

        const passwordData = {
            currentPassword: currentPassword,
            newPassword: newPassword
        };

        // Determine endpoint based on user role
        const endpoint = currentUser.role === 'GUEST' ? '/guests/me/password' : '/staff/me/password';

        $.ajax({
            url: API_BASE_URL + endpoint,
            type: 'PUT',
            contentType: 'application/json',
            headers: {
                'Authorization': 'Bearer ' + jwtToken
            },
            data: JSON.stringify(passwordData),
            success: function(response) {
                if (response.status === 200) {
                    showSuccess('Password updated successfully!');
                    $('#securityForm')[0].reset();
                }
            },
            error: function(xhr) {
                showError('Failed to update password: ' + (xhr.responseJSON?.message || 'Unknown error'));
            }
        });
    }

    // Upload image to imgbb and return the hosted URL
    // async function uploadImageToImgbb(file) {
    //     const formData = new FormData();
    //     formData.append("image", file);
    //
    //     try {
    //         const response = await $.ajax({
    //             url: `https://api.imgbb.com/1/upload?key=c8855e05a325a45010e5109d472fce84`,
    //             type: "POST",
    //             data: formData,
    //             processData: false,
    //             contentType: false
    //         });
    //
    //         if (response && response.data && response.data.url) {
    //             return response.data.url;
    //         } else {
    //             throw new Error("Invalid response from imgbb");
    //         }
    //     } catch (err) {
    //         console.error("Image upload failed:", err);
    //         showError("Failed to upload image. Please try again.");
    //         return null;
    //     }
    // }

    // Upload image to imgbb and return the hosted URL
    async function uploadImageToImgbb(file) {
        const formData = new FormData();
        formData.append("image", file);

        // Show "Uploading" message if theres a preview container available
        if ($('#proofPreview').length) {
            $('#proofPreview').html('<div class="alert alert-info">Uploading image...</div>');
        }

        try {
            const response = await $.ajax({
                url: `https://api.imgbb.com/1/upload?key=c8855e05a325a45010e5109d472fce84`,
                type: "POST",
                data: formData,
                processData: false,
                contentType: false
            });

            if (response && response.data && response.data.url) {
                // Show success message only for proof uploads
                if ($('#proofPreview').length) {
                    $('#proofPreview').html(`
                    <div class="alert alert-success">
                        <i class="fas fa-check-circle me-2"></i>
                        Image uploaded successfully!
                    </div>
                `);
                }
                return response.data.url;
            } else {
                throw new Error("Invalid response from imgbb");
            }
        } catch (err) {
            console.error("Image upload failed:", err);
            showError("Failed to upload image. Please try again.");
            if ($('#proofPreview').length) {
                $('#proofPreview').html(`
                <div class="alert alert-danger">
                    <i class="fas fa-exclamation-circle me-2"></i>
                    Upload failed
                </div>
            `);
            }
            return null;
        }
    }

    // Report lost item
    // function reportLostItem() {
    //     if (!currentUser || !jwtToken) {
    //         showError('Please login first to report a lost item.');
    //         $('#reportModal').modal('hide');
    //         $('#loginModal').modal('show');
    //         return;
    //     }
    //
    //     const itemData = {
    //         guestId: currentUser.guestId || currentUser.id,
    //         title: $('#itemName').val(),
    //         description: $('#itemDescription').val(),
    //         dateLost: $('#lostDate').val(),
    //         locationLost: $('#lostLocation').val(),
    //         imagePath: '' // You would handle file upload separately
    //     };
    //
    //     $.ajax({
    //         url: API_BASE_URL + '/lost-items',
    //         type: 'POST',
    //         contentType: 'application/json',
    //         headers: {
    //             'Authorization': 'Bearer ' + jwtToken
    //         },
    //         data: JSON.stringify(itemData),
    //         success: function(response) {
    //             if (response.status === 200) {
    //                 showSuccess('Item reported successfully!');
    //                 $('#reportModal').modal('hide');
    //                 loadDashboardData(); // Refresh data
    //             }
    //         },
    //         error: function(xhr) {
    //             showError('Failed to report item: ' + (xhr.responseJSON?.message || 'Unknown error'));
    //         }
    //     });
    // }

    async function reportLostItem() {
        if (!currentUser || !jwtToken) {
            showError('Please login first to report a lost item.');
            $('#reportModal').modal('hide');
            $('#loginModal').modal('show');
            return;
        }

        const file = $('#lostItemImage')[0]?.files[0]; // add input for image in your form
        let imageUrl = '';

        if (file) {
            imageUrl = await uploadImageToImgbb(file);
            if (!imageUrl) return; // stop if upload failed
        }

        const itemData = {
            guestId: currentUser.guestId || currentUser.id,
            title: $('#itemName').val(),
            description: $('#itemDescription').val(),
            dateLost: $('#lostDate').val(),
            locationLost: $('#lostLocation').val(),
            imagePath: imageUrl
        };

        $.ajax({
            url: API_BASE_URL + '/lost-items',
            type: 'POST',
            contentType: 'application/json',
            headers: { 'Authorization': 'Bearer ' + jwtToken },
            data: JSON.stringify(itemData),
            success: function(response) {
                if (response.status === 200) {
                    showSuccess('Item reported successfully!');
                    $('#reportModal').modal('hide');
                    loadDashboardData();
                }
            },
            error: function(xhr) {
                showError('Failed to report item: ' + (xhr.responseJSON?.message || 'Unknown error'));
            }
        });
    }

    // Report found item
    // function reportFoundItem() {
    //     if (!currentUser || !jwtToken) {
    //         showError('Please login first to report a found item.');
    //         $('#foundModal').modal('hide');
    //         $('#loginModal').modal('show');
    //         return;
    //     }
    //
    //     // Only staff can report found items
    //     if (!currentUser.role || currentUser.role === 'GUEST') {
    //         showError('Only hotel staff can report found items.');
    //         $('#foundModal').modal('hide');
    //         return;
    //     }
    //
    //     const itemData = {
    //         staffId: currentUser.staffId || currentUser.id,
    //         title: $('#foundItemName').val(),
    //         description: $('#foundItemDescription').val(),
    //         foundDate: $('#foundDate').val(),
    //         locationFound: $('#foundLocation').val(),
    //         imagePath: '' // You would handle file upload separately
    //     };
    //
    //     $.ajax({
    //         url: API_BASE_URL + '/found-items',
    //         type: 'POST',
    //         contentType: 'application/json',
    //         headers: {
    //             'Authorization': 'Bearer ' + jwtToken
    //         },
    //         data: JSON.stringify(itemData),
    //         success: function(response) {
    //             if (response.status === 200) {
    //                 showSuccess('Found item reported successfully!');
    //                 $('#foundModal').modal('hide');
    //                 loadDashboardData(); // Refresh data
    //             }
    //         },
    //         error: function(xhr) {
    //             showError('Failed to report found item: ' + (xhr.responseJSON?.message || 'Unknown error'));
    //         }
    //     });
    // }

    async function reportFoundItem() {
        if (!currentUser || !jwtToken) {
            showError('Please login first to report a found item.');
            $('#foundModal').modal('hide');
            $('#loginModal').modal('show');
            return;
        }

        if (!currentUser.role || currentUser.role === 'GUEST') {
            showError('Only hotel staff can report found items.');
            $('#foundModal').modal('hide');
            return;
        }

        const file = $('#foundItemImage')[0]?.files[0]; // add input for found item image
        let imageUrl = '';

        if (file) {
            imageUrl = await uploadImageToImgbb(file);
            if (!imageUrl) return;
        }

        const itemData = {
            staffId: currentUser.staffId || currentUser.id,
            title: $('#foundItemName').val(),
            description: $('#foundItemDescription').val(),
            foundDate: $('#foundDate').val(),
            locationFound: $('#foundLocation').val(),
            imagePath: imageUrl
        };

        $.ajax({
            url: API_BASE_URL + '/found-items',
            type: 'POST',
            contentType: 'application/json',
            headers: { 'Authorization': 'Bearer ' + jwtToken },
            data: JSON.stringify(itemData),
            success: function(response) {
                if (response.status === 200) {
                    showSuccess('Found item reported successfully!');
                    $('#foundModal').modal('hide');
                    loadDashboardData();
                }
            },
            error: function(xhr) {
                showError('Failed to report found item: ' + (xhr.responseJSON?.message || 'Unknown error'));
            }
        });
    }

    // Submit claim for an item
    // function submitClaim() {
    //     const itemId = $('#claimItemId').val();
    //     const message = $('#claimMessage').val();
    //     const proofImage = $('#claimProof')[0].files[0];
    //
    //     // Create form data for file upload
    //     const formData = new FormData();
    //     formData.append('foundItemId', itemId);
    //     formData.append('message', message);
    //     if (proofImage) {
    //         formData.append('proofImage', proofImage);
    //     }
    //
    //     $.ajax({
    //         url: API_BASE_URL + '/claims',
    //         type: 'POST',
    //         headers: {
    //             'Authorization': 'Bearer ' + jwtToken
    //         },
    //         data: formData,
    //         processData: false,
    //         contentType: false,
    //         success: function(response) {
    //             if (response.status === 200) {
    //                 showSuccess('Claim submitted successfully! The admin will review your request.');
    //                 $('#claimItemModal').modal('hide');
    //                 loadDashboardData(); // Refresh data
    //             }
    //         },
    //         error: function(xhr) {
    //             showError('Failed to submit claim: ' + (xhr.responseJSON?.message || 'Unknown error'));
    //         }
    //     });
    // }

    function submitClaim() {
        const itemId = $('#claimItemId').val();
        const message = $('#claimMessage').val();
        const proofImageUrl = $('#claimProof').data("uploadedUrl") || null;

        const claimData = {
            foundItemId: itemId,
            message: message,
            proofImageUrl: proofImageUrl
        };

        $.ajax({
            url: API_BASE_URL + '/claims',
            type: 'POST',
            contentType: 'application/json',
            headers: {
                'Authorization': 'Bearer ' + jwtToken
            },
            data: JSON.stringify(claimData),
            success: function(response) {
                if (response.status === 200) {
                    showSuccess('Claim submitted successfully! The admin will review your request.');
                    $('#claimItemModal').modal('hide');
                    loadDashboardData();
                }
            },
            error: function(xhr) {
                showError('Failed to submit claim: ' + (xhr.responseJSON?.message || 'Unknown error'));
            }
        });
    }


    // Handle proof upload
    // function handleProofUpload(e) {
    //     const file = e.target.files[0];
    //     if (!file) return;
    //
    //     // In a real implementation, you would upload the file to a server
    //     const reader = new FileReader();
    //     reader.onload = function(e) {
    //         $('#proofPreview').html(`
    //             <div class="alert alert-info">
    //                 <i class="fas fa-check-circle me-2"></i>
    //                 File selected: ${file.name}
    //             </div>
    //         `);
    //     };
    //     reader.readAsDataURL(file);
    // }

    // Handle proof upload
    function handleProofUpload(e) {
        const file = e.target.files[0];
        if (!file) return;

        const apiKey = "c8855e05a325a45010e5109d472fce84"; // ImgBB API key
        const formData = new FormData();
        formData.append("image", file);

        // Show "uploading..." while waiting
        $('#proofPreview').html(`
        <div class="alert alert-warning">
            <i class="fas fa-spinner fa-spin me-2"></i>
            Uploading ${file.name}...
        </div>
    `);

        $.ajax({
            url: `https://api.imgbb.com/1/upload?key=${apiKey}`,
            type: "POST",
            data: formData,
            processData: false,
            contentType: false,
            success: function(response) {
                if (response && response.data && response.data.url) {
                    const imageUrl = response.data.url;

                    // Save this URL globally to attach in submitClaim()
                    $('#claimProof').data("uploadedUrl", imageUrl);

                    $('#proofPreview').html(`
                    <div class="alert alert-success">
                        <i class="fas fa-check-circle me-2"></i>
                        Uploaded successfully! <br>
                        <a href="${imageUrl}" target="_blank">View Image</a>
                    </div>
                `);
                } else {
                    $('#proofPreview').html(`
                    <div class="alert alert-danger">Upload failed, please try again.</div>
                `);
                }
            },
            error: function(err) {
                console.error("Upload failed:", err);
                $('#proofPreview').html(`
                <div class="alert alert-danger">Error uploading file.</div>
            `);
            }
        });
    }

    // Load dashboard data based on user role
    function loadDashboardData() {
        if (!currentUser || !jwtToken) return;

        // Update dashboard title based on user role
        if (currentUser.role === 'ADMIN') {
            $('#dashboardTitle').text('Admin Dashboard');
            $('#adminPanelSection').removeClass('d-none');
            $('#claimRequestsSection').removeClass('d-none');
            $('#addItemBtn').removeClass('d-none');
            loadAdminData();
        } else if (currentUser.role === 'STAFF') {
            $('#dashboardTitle').text('Staff Dashboard');
            $('#adminPanelSection').addClass('d-none');
            $('#claimRequestsSection').addClass('d-none');
            $('#addItemBtn').removeClass('d-none');
            loadStaffData();
        } else {
            $('#dashboardTitle').text('My Dashboard');
            $('#adminPanelSection').addClass('d-none');
            $('#claimRequestsSection').addClass('d-none');
            $('#addItemBtn').addClass('d-none');
            loadGuestData();
        }

        // Load profile data
        loadProfileData();
    }

    // // Load profile data
    // function loadProfileData() {
    //     if (!currentUser) return;
    //
    //     $('#profileUserName').text(currentUser.name || 'User Name');
    //     $('#profileUserRole').text(currentUser.role || 'Guest');
    //     $('#profileUserEmail').text(currentUser.email || 'email@example.com');
    //
    //     $('#profileName').val(currentUser.name || '');
    //     $('#profileEmail').val(currentUser.email || '');
    //     $('#profilePhone').val(currentUser.phone || '');
    // }

    // Load profile data
    function loadProfileData() {
        if (!currentUser) return;

        // Determine endpoint based on user role
        const endpoint = currentUser.role === 'GUEST' ? '/guests/profile' : '/staff/profile';

        $.ajax({
            url: API_BASE_URL + endpoint,
            type: 'GET',
            headers: {
                'Authorization': 'Bearer ' + jwtToken
            },
            success: function(response) {
                if (response.status === 200) {
                    const profile = response.data;

                    // Update profile fields
                    $('#profileUserName').text(profile.name || 'User Name');
                    $('#profileUserRole').text(currentUser.role || 'Guest');
                    $('#profileUserEmail').text(profile.email || 'email@example.com');

                    $('#profileName').val(profile.name || '');
                    $('#profileEmail').val(profile.email || '');
                    $('#profilePhone').val(profile.phone || '');
                }
            },
            error: function(xhr) {
                console.error('Failed to load profile:', xhr);
            }
        });
    }

    // Show profile section
    function showProfileSection() {
        $('#profileSection').removeClass('d-none');
        $('.dashboard-section:not(#profileSection)').addClass('d-none');
        $('.admin-panel').addClass('d-none');
    }

    // Show dashboard section
    function showDashboardSection() {
        $('#profileSection').addClass('d-none');
        $('.dashboard-section:not(#profileSection)').removeClass('d-none');
        $('.admin-panel').addClass('d-none');
    }

    // Show admin section
    function showAdminSection() {
        $('#profileSection').addClass('d-none');
        $('.dashboard-section').addClass('d-none');
        $('.admin-panel').removeClass('d-none');
    }

    // Show home section
    function showHomeSection() {
        $('#dashboardSection').addClass('d-none');
    }

    // Load data for admin users
    function loadAdminData() {
        // Load lost items (admin can see all)
        $.ajax({
            url: API_BASE_URL + '/lost-items',
            type: 'GET',
            headers: {
                'Authorization': 'Bearer ' + jwtToken
            },
            success: function(response) {
                if (response.status === 200) {
                    populateLostItemsTable(response.data);
                }
            },
            error: function(xhr) {
                console.error('Failed to load lost items:', xhr);
                showError('Failed to load lost items');
            }
        });

        // Load found items (admin can see all)
        $.ajax({
            url: API_BASE_URL + '/found-items',
            type: 'GET',
            headers: {
                'Authorization': 'Bearer ' + jwtToken
            },
            success: function(response) {
                if (response.status === 200) {
                    populateFoundItemsTable(response.data);
                }
            },
            error: function(xhr) {
                console.error('Failed to load found items:', xhr);
                showError('Failed to load found items');
            }
        });

        // Load stats
        loadAdminStats();

        // Load guests (admin only)
        $.ajax({
            url: API_BASE_URL + '/guests',
            type: 'GET',
            headers: {
                'Authorization': 'Bearer ' + jwtToken
            },
            success: function(response) {
                if (response.status === 200) {
                    // You could display guests in the admin section
                    console.log('Guests loaded:', response.data.length);
                }
            },
            error: function(xhr) {
                console.error('Failed to load guests:', xhr);
            }
        });

        // Load hotels (admin only)
        $.ajax({
            url: API_BASE_URL + '/hotels',
            type: 'GET',
            headers: {
                'Authorization': 'Bearer ' + jwtToken
            },
            success: function(response) {
                if (response.status === 200) {
                    populateHotelsTable(response.data);
                }
            },
            error: function(xhr) {
                console.error('Failed to load hotels:', xhr);
            }
        });

        // Load claims (admin only)
        $.ajax({
            url: API_BASE_URL + '/claims',
            type: 'GET',
            headers: {
                'Authorization': 'Bearer ' + jwtToken
            },
            success: function(response) {
                if (response.status === 200) {
                    populateClaimRequestsTable(response.data);
                }
            },
            error: function(xhr) {
                console.error('Failed to load claims:', xhr);
            }
        });

        // Load staff (admin only)
        $.ajax({
            url: API_BASE_URL + '/staff/all',
            type: 'GET',
            headers: {
                'Authorization': 'Bearer ' + jwtToken
            },
            success: function(response) {
                if (response.status === 200) {
                    populateStaffTable(response.data);
                }
            },
            error: function(xhr) {
                console.error('Failed to load staff:', xhr);
            }
        });
    }

    // Load data for staff users
    function loadStaffData() {
        // Load lost items (staff can see all)
        $.ajax({
            url: API_BASE_URL + '/lost-items',
            type: 'GET',
            headers: {
                'Authorization': 'Bearer ' + jwtToken
            },
            success: function(response) {
                if (response.status === 200) {
                    populateLostItemsTable(response.data);
                }
            },
            error: function(xhr) {
                console.error('Failed to load lost items:', xhr);
                showError('Failed to load lost items');
            }
        });

        // Load found items (staff can see all)
        $.ajax({
            url: API_BASE_URL + '/found-items',
            type: 'GET',
            headers: {
                'Authorization': 'Bearer ' + jwtToken
            },
            success: function(response) {
                if (response.status === 200) {
                    populateFoundItemsTable(response.data);
                }
            },
            error: function(xhr) {
                console.error('Failed to load found items:', xhr);
                showError('Failed to load found items');
            }
        });

        // Load staff stats
        loadStaffStats();
    }

    // Load data for guest users
    function loadGuestData() {
        // Load guest's lost items
        $.ajax({
            url: API_BASE_URL + '/lost-items/me',
            type: 'GET',
            headers: {
                'Authorization': 'Bearer ' + jwtToken
            },
            success: function(response) {
                if (response.status === 200) {
                    // For guests, we need to filter by their ID
                    const guestItems = response.data.filter(item => {
                        // Check if the item belongs to the current guest
                        return item.guestId === currentUser.guestId ||
                            (item.guest && item.guest.guestId === currentUser.guestId) ||
                            (currentUser.id && item.guestId === currentUser.id);
                    });
                    populateLostItemsTable(guestItems);
                }
            },
            error: function(xhr) {
                console.error('Failed to load lost items:', xhr);
                showError('Failed to load your lost items');
            }
        });

        // Load found items that might match guest's lost items
        // Guests can see all unclaimed found items to check if their item is there
        $.ajax({
            url: API_BASE_URL + '/found-items/unclaimed',
            type: 'GET',
            headers: {
                'Authorization': 'Bearer ' + jwtToken
            },
            success: function(response) {
                if (response.status === 200) {
                    // Filter to show only unclaimed items for guests
                    const unclaimedItems = response.data.filter(item =>
                        item.status && item.status.toLowerCase().includes('unclaimed')
                    );
                    populateFoundItemsTable(unclaimedItems);
                }
            },
            error: function(xhr) {
                console.error('Failed to load found items:', xhr);
            }
        });

        // Load notifications for guest
        if (currentUser.guestId) {
            loadNotifications();
        }

        // Load guest stats
        loadGuestStats();
    }

    // Load notifications for the current user
    function loadNotifications() {
        if (!currentUser || !currentUser.guestId) {
            $('#notificationsList').html('<p class="text-center">Notifications are only available for guests.</p>');
            return;
        }

        $('#notificationsLoading').removeClass('d-none');

        $.ajax({
            // url: API_BASE_URL + '/notifications/guest/' + currentUser.guestId,
            url: API_BASE_URL + '/notifications/me',
            type: 'GET',
            headers: {
                'Authorization': 'Bearer ' + jwtToken
            },
            success: function(response) {
                $('#notificationsLoading').addClass('d-none');

                if (response.status === 200) {
                    notifications = response.data;

                    // Update notification badge
                    if (notifications && notifications.length > 0) {
                        const unreadCount = notifications.filter(n => !n.isRead).length;
                        $('#notificationsBadge').removeClass('d-none').text(unreadCount);
                    } else {
                        $('#notificationsBadge').addClass('d-none');
                    }

                    // Display notifications
                    displayNotifications(notifications);
                } else {
                    $('#notificationsList').html('<p class="text-center">Failed to load notifications.</p>');
                }
            },
            error: function(xhr) {
                $('#notificationsLoading').addClass('d-none');
                console.error('Failed to load notifications:', xhr);
                $('#notificationsList').html('<p class="text-center">Error loading notifications. Please try again later.</p>');
            }
        });
    }

    // Display notifications in the modal
    function displayNotifications(notifications) {
        const notificationsList = $('#notificationsList');
        notificationsList.empty();

        if (!notifications || notifications.length === 0) {
            notificationsList.html('<p class="text-center">No notifications found.</p>');
            return;
        }

        notifications.forEach(notification => {
            const notificationItem = `
                <div class="card mb-3 ${notification.isRead ? '' : 'border-primary'}" data-id="${notification.id}">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start">
                            <div>
                                <h6 class="card-title mb-1">${notification.type || 'Notification'}</h6>
                                <p class="card-text mb-2">${notification.message || 'No message content'}</p>
                                <small class="text-muted">${formatDate(notification.sentDate)}</small>
                            </div>
                            ${!notification.isRead ? `
                            <button class="btn btn-sm btn-outline-primary mark-as-read-btn" data-id="${notification.id}">
                                Mark as Read
                            </button>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `;
            notificationsList.append(notificationItem);
        });

        // Add event listeners for mark as read buttons
        $('.mark-as-read-btn').on('click', function() {
            const notificationId = $(this).data('id');
            markNotificationAsRead(notificationId);
        });
    }

    // Mark a notification as read
    function markNotificationAsRead(notificationId) {
        $.ajax({
            url: API_BASE_URL + '/notifications/' + notificationId + '/read',
            type: 'PUT',
            headers: {
                'Authorization': 'Bearer ' + jwtToken
            },
            success: function(response) {
                if (response.status === 200) {
                    // Update the UI
                    $(`.card[data-id="${notificationId}"]`).removeClass('border-primary');
                    $(`.mark-as-read-btn[data-id="${notificationId}"]`).remove();

                    // Update the notification badge
                    const unreadCount = $('.card.border-primary').length;
                    if (unreadCount > 0) {
                        $('#notificationsBadge').removeClass('d-none').text(unreadCount);
                    } else {
                        $('#notificationsBadge').addClass('d-none');
                    }

                    showSuccess('Notification marked as read');
                }
            },
            error: function(xhr) {
                console.error('Failed to mark notification as read:', xhr);
                showError('Failed to mark notification as read. Please try again.');
            }
        });
    }

    // Mark all notifications as read
    function markAllNotificationsAsRead() {
        const unreadNotifications = notifications.filter(n => !n.isRead);

        if (unreadNotifications.length === 0) {
            showInfo('All notifications are already read');
            return;
        }

        // Mark all as read in the UI first for better UX
        $('.card').removeClass('border-primary');
        $('.mark-as-read-btn').remove();
        $('#notificationsBadge').addClass('d-none');

        // Send requests to mark all as read
        const promises = unreadNotifications.map(notification => {
            return $.ajax({
                url: API_BASE_URL + '/notifications/' + notification.id + '/read',
                type: 'PUT',
                headers: {
                    'Authorization': 'Bearer ' + jwtToken
                }
            });
        });

        // Handle all requests
        Promise.all(promises)
            .then(() => {
                showSuccess('All notifications marked as read');
            })
            .catch(error => {
                console.error('Failed to mark some notifications as read:', error);
                showError('Some notifications may not have been marked as read. Please try again.');
            });
    }

    // Populate lost items table
    function populateLostItemsTable(items) {
        const tbody = $('#lostItemsTable tbody');
        tbody.empty();

        if (!items || items.length === 0) {
            tbody.append('<tr><td colspan="5" class="text-center py-4">No lost items found</td></tr>');
            return;
        }

        items.forEach(item => {
            const statusClass = getStatusClass(item.status);
            const row = `
                <tr data-status="${item.status ? item.status.toLowerCase() : ''}">
                    <td>${item.title || 'Unknown Item'}</td>
                    <td>${item.guestName || (item.guest && item.guest.name) || 'Unknown Guest'}</td>
                    <td>${formatDate(item.reportedDate) || 'N/A'}</td>
                    <td><span class="status-badge ${statusClass}">${item.status || 'UNKNOWN'}</span></td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary view-item action-btn" data-id="${item.lostId}">View</button>
                        ${currentUser.role === 'GUEST' ? `
                        <button class="btn btn-sm btn-outline-secondary edit-item action-btn" data-id="${item.lostId}">Edit</button>
                        ` : ''}
                        ${(currentUser.role === 'ADMIN' || currentUser.role === 'STAFF') ? `
                        <button class="btn btn-sm btn-outline-danger archive-item action-btn" data-id="${item.lostId}">Archive</button>
                        ` : ''}
                    </td>
                </tr>
            `;
            tbody.append(row);
        });

        // Add event listeners
        $('.view-item').on('click', function() {
            const itemId = $(this).data('id');
            viewItem(itemId, 'lost');
        });

        $('.edit-item').on('click', function() {
            const itemId = $(this).data('id');
            editItem(itemId, 'lost');
        });

        $('.archive-item').on('click', function() {
            const itemId = $(this).data('id');
            archiveItem(itemId, 'lost');
        });
    }

    // Populate found items table
    function populateFoundItemsTable(items) {
        const tbody = $('#foundItemsTable tbody');
        tbody.empty();

        if (!items || items.length === 0) {
            tbody.append('<tr><td colspan="5" class="text-center py-4">No found items found</td></tr>');
            return;
        }

        items.forEach(item => {
            const statusClass = getStatusClass(item.status);
            const row = `
                <tr data-status="${item.status ? item.status.toLowerCase() : ''}">
                    <td>${item.title || 'Unknown Item'}</td>
                    <td>${item.staffName || (item.staff && item.staff.name) || 'Unknown Staff'}</td>
                    <td>${formatDate(item.foundDate) || 'N/A'}</td>
                    <td><span class="status-badge ${statusClass}">${item.status || 'UNKNOWN'}</span></td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary view-item action-btn" data-id="${item.foundId}">View</button>
                        ${(currentUser.role === 'ADMIN' || currentUser.role === 'STAFF') ? `
                        <button class="btn btn-sm btn-outline-success match-item action-btn" data-id="${item.foundId}">Match</button>
                        <button class="btn btn-sm btn-outline-danger archive-item action-btn" data-id="${item.foundId}">Archive</button>
                        ` : ''}
                        ${(currentUser.role === 'GUEST' && item.status && item.status.toLowerCase().includes('unclaimed')) ? `
                        <button class="btn btn-sm btn-outline-warning claim-item action-btn" data-id="${item.foundId}" data-name="${item.title || 'Unknown Item'}">Claim</button>
                        ` : ''}
                    </td>
                </tr>
            `;
            tbody.append(row);
        });

        // Add event listeners
        $('.view-item').on('click', function() {
            const itemId = $(this).data('id');
            viewItem(itemId, 'found');
        });

        $('.match-item').on('click', function() {
            const itemId = $(this).data('id');
            matchItem(itemId);
        });

        $('.archive-item').on('click', function() {
            const itemId = $(this).data('id');
            archiveItem(itemId, 'found');
        });

        $('.claim-item').on('click', function() {
            const itemId = $(this).data('id');
            const itemName = $(this).data('name');
            claimItem(itemId, itemName);
        });
    }

    // Populate hotels table
    function populateHotelsTable(hotels) {
        const tbody = $('#hotelsTable tbody');
        tbody.empty();

        if (!hotels || hotels.length === 0) {
            tbody.append('<tr><td colspan="4" class="text-center py-4">No hotels found</td></tr>');
            return;
        }

        hotels.forEach(hotel => {
            const row = `
                <tr>
                    <td>${hotel.name || 'Unknown Hotel'}</td>
                    <td>${hotel.address || 'N/A'}</td>
                    <td>${hotel.phone || 'N/A'}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary edit-hotel action-btn" data-id="${hotel.hotelId}">Edit</button>
                        <button class="btn btn-sm btn-outline-danger delete-hotel action-btn" data-id="${hotel.hotelId}">Delete</button>
                    </td>
                </tr>
            `;
            tbody.append(row);
        });
    }

    // Populate staff table
    function populateStaffTable(staff) {
        const tbody = $('#staffTable tbody');
        tbody.empty();

        if (!staff || staff.length === 0) {
            tbody.append('<tr><td colspan="5" class="text-center py-4">No staff members found</td></tr>');
            return;
        }

        staff.forEach(staffMember => {
            const row = `
                <tr>
                    <td>${staffMember.name || 'Unknown Staff'}</td>
                    <td>${staffMember.email || 'N/A'}</td>
                    <td>${staffMember.role || 'N/A'}</td>
                    <td>${staffMember.hotelName || 'N/A'}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary edit-staff action-btn" data-id="${staffMember.staffId}">Edit</button>
                        <button class="btn btn-sm btn-outline-danger delete-staff action-btn" data-id="${staffMember.staffId}">Delete</button>
                    </td>
                </tr>
            `;
            tbody.append(row);
        });
    }

    // Populate claim requests table
    function populateClaimRequestsTable(claims) {
        const tbody = $('#claimRequestsTable tbody');
        tbody.empty();

        if (!claims || claims.length === 0) {
            tbody.append('<tr><td colspan="5" class="text-center py-4">No claim requests found</td></tr>');
            $('#claimRequestsCount').text('0');
            return;
        }

        $('#claimRequestsCount').text(claims.length);

        claims.forEach(claim => {
            const statusClass = getStatusClass(claim.status);
            const row = `
                <tr>
                    <td>${claim.foundItemTitle || 'Unknown Item'}</td>
                    <td>${claim.guestName || 'Unknown Guest'}</td>
                    <td>${formatDate(claim.claimDate) || 'N/A'}</td>
                    <td><span class="status-badge ${statusClass}">${claim.status || 'PENDING'}</span></td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary view-claim action-btn" data-id="${claim.claimId}">View</button>
                        <button class="btn btn-sm btn-outline-success approve-claim action-btn" data-id="${claim.claimId}">Approve</button>
                        <button class="btn btn-sm btn-outline-danger reject-claim action-btn" data-id="${claim.claimId}">Reject</button>
                    </td>
                </tr>
            `;
            tbody.append(row);
        });

        // Add event listeners
        $('.view-claim').on('click', function() {
            const claimId = $(this).data('id');
            viewClaim(claimId);
        });

        $('.approve-claim').on('click', function() {
            const claimId = $(this).data('id');
            replyToClaim(claimId, true);
        });

        $('.reject-claim').on('click', function() {
            const claimId = $(this).data('id');
            replyToClaim(claimId, false);
        });
    }

    // // View item details
    // function viewItem(itemId, type) {
    //     // In a real implementation, you would fetch item details and show them
    //     showInfo(`Viewing ${type} item #${itemId}`);
    // }

    // View item details
    function viewItem(itemId, type) {
        $.ajax({
            url: API_BASE_URL + `/${type}-items/${itemId}`,
            type: 'GET',
            headers: {
                'Authorization': 'Bearer ' + jwtToken
            },
            success: function(response) {
                if (response.status === 200) {
                    // Display item details in a modal or dedicated section
                    showItemDetails(response.data, type);
                }
            },
            error: function(xhr) {
                console.error(`Failed to load ${type} item:`, xhr);
                showError(`Failed to load ${type} item details`);
            }
        });
    }

    // Display item details (lost or found) in a modal
    function showItemDetails(item, type) {
        const modalBody = $('#itemDetailsModal .modal-body');
        modalBody.empty();

        const imageHtml = item.imagePath
            ? `<img src="${item.imagePath}" class="img-fluid rounded mb-3" alt="Item Image">`
            : `<div class="alert alert-secondary">No image available</div>`;

        const detailsHtml = `
        <h5>${item.title || 'Unknown Item'}</h5>
        <p>${item.description || 'No description provided.'}</p>
        <ul class="list-unstyled">
            <li><strong>Reported By:</strong> ${item.guestName || item.staffName || 'N/A'}</li>
            <li><strong>Date:</strong> ${formatDate(item.reportedDate || item.foundDate)}</li>
            <li><strong>Location:</strong> ${item.locationLost || item.locationFound || 'N/A'}</li>
            <li><strong>Status:</strong> ${item.status || 'UNKNOWN'}</li>
        </ul>
        ${imageHtml}
    `;

        modalBody.html(detailsHtml);

        // Show the modal
        $('#itemDetailsModal').modal('show');
    }

    // Show claim details in a modal (admin view)
    function showClaimDetails(claim) {
        const modalBody = $('#claimDetailsModal .modal-body');
        modalBody.empty();

        const proofHtml = claim.proofImageUrl
            ? `<img src="${claim.proofImageUrl}" class="img-fluid rounded mb-3" alt="Proof Image">`
            : `<div class="alert alert-secondary">No proof image provided</div>`;

        const detailsHtml = `
        <h5>Claim for: ${claim.foundItemTitle || 'Unknown Item'}</h5>
        <p><strong>Guest:</strong> ${claim.guestName || 'N/A'}</p>
        <p><strong>Message:</strong> ${claim.message || 'No message provided.'}</p>
        <p><strong>Status:</strong> ${claim.status || 'PENDING'}</p>
        <p><strong>Date:</strong> ${formatDate(claim.claimDate)}</p>
        ${proofHtml}
        <div class="d-flex justify-content-end mt-3">
            <button class="btn btn-success me-2" id="approveClaimBtn" data-id="${claim.claimId}">Approve</button>
            <button class="btn btn-danger" id="rejectClaimBtn" data-id="${claim.claimId}">Reject</button>
        </div>
    `;

        modalBody.html(detailsHtml);
        $('#claimDetailsModal').modal('show');

        // Attach event listeners
        $('#approveClaimBtn').on('click', function() {
            replyToClaim(claim.claimId, true);
            $('#claimDetailsModal').modal('hide');
        });

        $('#rejectClaimBtn').on('click', function() {
            replyToClaim(claim.claimId, false);
            $('#claimDetailsModal').modal('hide');
        });
    }

    // Edit item
    function editItem(itemId, type) {
        // In a real implementation, you would fetch item details and show an edit form
        showInfo(`Editing ${type} item #${itemId}`);
    }

    // // Archive item
    // function archiveItem(itemId, type) {
    //     showConfirm(`Are you sure you want to archive this ${type} item?`, function() {
    //         // In a real implementation, you would make an API call to archive the item
    //         showSuccess(`${type.charAt(0).toUpperCase() + type.slice(1)} item archived successfully!`);
    //     });
    // }

    // Archive item
    function archiveItem(itemId, type) {
        showConfirm(`Are you sure you want to archive this ${type} item?`, function() {
            $.ajax({
                url: API_BASE_URL + `/${type}-items/${itemId}/archive`,
                type: 'PUT',
                headers: {
                    'Authorization': 'Bearer ' + jwtToken
                },
                success: function(response) {
                    if (response.status === 200) {
                        showSuccess(`${type.charAt(0).toUpperCase() + type.slice(1)} item archived successfully!`);
                        loadDashboardData(); // Refresh data
                    }
                },
                error: function(xhr) {
                    console.error(`Failed to archive ${type} item:`, xhr);
                    showError(`Failed to archive ${type} item`);
                }
            });
        });
    }

    // Match item
    function matchItem(itemId) {
        // In a real implementation, you would show a form to match the found item with a lost item
        showInfo(`Matching found item #${itemId}`);
    }

    // Claim item
    function claimItem(itemId, itemName) {
        $('#claimItemId').val(itemId);
        $('#claimItemName').text(itemName);
        $('#claimMessage').val('');
        $('#proofPreview').html('');
        $('#claimItemModal').modal('show');
    }

    // View claim details
    function viewClaim(claimId) {
        $.ajax({
            url: API_BASE_URL + `/claims/${claimId}`,
            type: 'GET',
            headers: {
                'Authorization': 'Bearer ' + jwtToken
            },
            success: function(response) {
                if (response.status === 200) {
                    showClaimDetails(response.data);
                }
            },
            error: function(xhr) {
                console.error('Failed to load claim details:', xhr);
                showError('Failed to load claim details');
            }
        });
    }

    // Reply to claim (approve/reject)
    function replyToClaim(claimId, approve) {
        const message = prompt(`Please enter a message for the ${approve ? 'approval' : 'rejection'}:`);
        if (message === null) return; // User cancelled

        const replyData = {
            message: message,
            approve: approve
        };

        $.ajax({
            url: API_BASE_URL + `/claims/${claimId}/reply`,
            type: 'PUT',
            contentType: 'application/json',
            headers: {
                'Authorization': 'Bearer ' + jwtToken
            },
            data: JSON.stringify(replyData),
            success: function(response) {
                if (response.status === 200) {
                    showSuccess(`Claim ${approve ? 'approved' : 'rejected'} successfully!`);
                    loadDashboardData(); // Refresh data
                }
            },
            error: function(xhr) {
                console.error('Failed to reply to claim:', xhr);
                showError('Failed to process claim request');
            }
        });
    }

    // Filter items by status
    function filterItems(filter) {
        if (filter === 'all') {
            $('#lostItemsTable tbody tr, #foundItemsTable tbody tr').show();
        } else {
            $('#lostItemsTable tbody tr').hide();
            $('#foundItemsTable tbody tr').hide();
            $(`#lostItemsTable tbody tr[data-status*="${filter}"], #foundItemsTable tbody tr[data-status*="${filter}"]`).show();
        }
    }

    // Helper function to get CSS class for status
    function getStatusClass(status) {
        if (!status) return 'status-unclaimed';

        status = status.toLowerCase();
        if (status.includes('pending')) return 'status-pending';
        if (status.includes('match')) return 'status-matched';
        if (status.includes('close')) return 'status-closed';
        if (status.includes('unclaim')) return 'status-unclaimed';
        if (status.includes('claim')) return 'status-claimed';
        return 'status-unclaimed';
    }

    // Helper function to format date
    function formatDate(dateString) {
        if (!dateString) return 'N/A';

        try {
            const date = new Date(dateString);
            return date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
        } catch (e) {
            return 'N/A';
        }
    }

    // Update UI after login
    function updateUIAfterLogin() {
        $('#authButtons').addClass('d-none');
        $('#userMenu').removeClass('d-none');
        $('#dashboardNavItem').removeClass('d-none');

        if (currentUser.role === 'ADMIN') {
            $('#adminNavItem').removeClass('d-none');
        }

        const username = currentUser.name || currentUser.email;
        $('#username').text(username);

        $('#dashboardSection').removeClass('d-none');

        // Update dashboard link based on role
        if (currentUser.role === 'ADMIN') {
            $('#dashboardLink').text('Admin Dashboard');
        } else if (currentUser.role === 'STAFF') {
            $('#dashboardLink').text('Staff Dashboard');
        } else {
            $('#dashboardLink').text('My Dashboard');
        }
    }

    // Logout function
    function logoutUser() {
        showConfirm('Are you sure you want to logout?', function() {
            localStorage.removeItem('jwtToken');
            localStorage.removeItem('currentUser');
            jwtToken = null;
            currentUser = null;
            notifications = [];

            $('#authButtons').removeClass('d-none');
            $('#userMenu').addClass('d-none');
            $('#dashboardNavItem').addClass('d-none');
            $('#adminNavItem').addClass('d-none');
            $('#dashboardSection').addClass('d-none');
            $('#notificationsBadge').addClass('d-none');

            showSuccess('You have been logged out successfully!');
        });
    }

    // Show info message
    function showInfo(message) {
        Swal.fire({
            icon: 'info',
            title: message,
            showConfirmButton: false,
            timer: 2000
        });
    }

    // // Load admin statistics
    // function loadAdminStats() {
    //     const statsHtml = `
    //         <div class="col-md-3">
    //             <div class="stat-card text-center p-3">
    //                 <div class="stat-number" id="lostItemsCount">0</div>
    //                 <div class="stat-label">Lost Items</div>
    //             </div>
    //         </div>
    //         <div class="col-md-3">
    //             <div class="stat-card text-center p-3">
    //                 <div class="stat-number" id="foundItemsCount">0</div>
    //                 <div class="stat-label">Found Items</div>
    //             </div>
    //         </div>
    //         <div class="col-md-3">
    //             <div class="stat-card text-center p-3">
    //                 <div class="stat-number" id="matchedItemsCount">0</div>
    //                 <div class="stat-label">Matched Items</div>
    //             </div>
    //         </div>
    //         <div class="col-md-3">
    //             <div class="stat-card text-center p-3">
    //                 <div class="stat-number" id="guestsCount">0</div>
    //                 <div class="stat-label">Registered Guests</div>
    //             </div>
    //         </div>
    //     `;
    //
    //     $('#statsSection').html(statsHtml);
    //
    //     // You would make API calls to get actual counts
    //     // For now, we'll set some placeholder values
    //     setTimeout(() => {
    //         $('#lostItemsCount').text('24');
    //         $('#foundItemsCount').text('18');
    //         $('#matchedItemsCount').text('12');
    //         $('#guestsCount').text('56');
    //     }, 500);
    // }
    //
    // // Load staff statistics
    // function loadStaffStats() {
    //     const statsHtml = `
    //         <div class="col-md-4">
    //             <div class="stat-card text-center p-3">
    //                 <div class="stat-number" id="staffLostItemsCount">0</div>
    //                 <div class="stat-label">Lost Items</div>
    //             </div>
    //         </div>
    //         <div class="col-md-4">
    //             <div class="stat-card text-center p-3">
    //                 <div class="stat-number" id="staffFoundItemsCount">0</div>
    //                 <div class="stat-label">Found Items</div>
    //             </div>
    //         </div>
    //         <div class="col-md-4">
    //             <div class="stat-card text-center p-3">
    //                 <div class="stat-number" id="staffMatchedItemsCount">0</div>
    //                 <div class="stat-label">Matched Items</div>
    //             </div>
    //         </div>
    //     `;
    //
    //     $('#statsSection').html(statsHtml);
    //
    //     // You would make API calls to get actual counts
    //     // For now, we'll set some placeholder values
    //     setTimeout(() => {
    //         $('#staffLostItemsCount').text('14');
    //         $('#staffFoundItemsCount').text('8');
    //         $('#staffMatchedItemsCount').text('5');
    //     }, 500);
    // }
    //
    // // Load guest statistics
    // function loadGuestStats() {
    //     const statsHtml = `
    //         <div class="col-md-6">
    //             <div class="stat-card text-center p-3">
    //                 <div class="stat-number" id="guestLostItemsCount">0</div>
    //                 <div class="stat-label">Your Lost Items</div>
    //             </div>
    //         </div>
    //         <div class="col-md-6">
    //             <div class="stat-card text-center p-3">
    //                 <div class="stat-number" id="guestMatchedItemsCount">0</div>
    //                 <div class="stat-label">Matched Items</div>
    //             </div>
    //         </div>
    //     `;
    //
    //     $('#statsSection').html(statsHtml);
    //
    //     // You would make API calls to get actual counts
    //     // For now, we'll set some placeholder values
    //     setTimeout(() => {
    //         $('#guestLostItemsCount').text('3');
    //         $('#guestMatchedItemsCount').text('1');
    //     }, 500);
    // }

    // Load Admin statistics
    function loadAdminStats() {
        const statsHtml = `
        <div class="col-md-3">
            <div class="stat-card text-center p-3">
                <div class="stat-number" id="lostItemsCount">0</div>
                <div class="stat-label">Lost Items</div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card text-center p-3">
                <div class="stat-number" id="foundItemsCount">0</div>
                <div class="stat-label">Found Items</div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card text-center p-3">
                <div class="stat-number" id="matchedItemsCount">0</div>
                <div class="stat-label">Matched Items</div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card text-center p-3">
                <div class="stat-number" id="guestsCount">0</div>
                <div class="stat-label">Registered Guests</div>
            </div>
        </div>
    `;
        $('#statsSection').html(statsHtml);

        $.ajax({
            url: API_BASE_URL + '/stats/admin',
            type: 'GET',
            headers: {
                'Authorization': 'Bearer ' + jwtToken
            },
            success: function (res) {
                const stats = res.data;
                $('#lostItemsCount').text(stats.lostItems);
                $('#foundItemsCount').text(stats.foundItems);
                $('#matchedItemsCount').text(stats.matchedItems);
                $('#guestsCount').text(stats.guests);
            },
            error: function () {
                console.error("Failed to load admin stats");
            }
        });
    }

    // Load Staff statistics
    function loadStaffStats() {
        const statsHtml = `
        <div class="col-md-4">
            <div class="stat-card text-center p-3">
                <div class="stat-number" id="staffLostItemsCount">0</div>
                <div class="stat-label">Lost Items</div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="stat-card text-center p-3">
                <div class="stat-number" id="staffFoundItemsCount">0</div>
                <div class="stat-label">Found Items</div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="stat-card text-center p-3">
                <div class="stat-number" id="staffMatchedItemsCount">0</div>
                <div class="stat-label">Matched Items</div>
            </div>
        </div>
    `;
        $('#statsSection').html(statsHtml);

        $.ajax({
            url: API_BASE_URL + '/stats/staff',
            type: 'GET',
            headers: {
                'Authorization': 'Bearer ' + jwtToken
            },
            success: function (res) {
                const stats = res.data;
                $('#staffLostItemsCount').text(stats.lostItems);
                $('#staffFoundItemsCount').text(stats.foundItems);
                $('#staffMatchedItemsCount').text(stats.matchedItems);
            },
            error: function () {
                console.error("Failed to load staff stats");
            }
        });
    }

    // Load Guest statistics
    function loadGuestStats() {
        const statsHtml = `
        <div class="col-md-6">
            <div class="stat-card text-center p-3">
                <div class="stat-number" id="guestLostItemsCount">0</div>
                <div class="stat-label">Your Lost Items</div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="stat-card text-center p-3">
                <div class="stat-number" id="guestMatchedItemsCount">0</div>
                <div class="stat-label">Matched Items</div>
            </div>
        </div>
    `;
        $('#statsSection').html(statsHtml);

        $.ajax({
            url: API_BASE_URL + '/stats/guest',
            type: 'GET',
            headers: {
                'Authorization': 'Bearer ' + jwtToken
            },
            success: function (res) {
                const stats = res.data;
                $('#guestLostItemsCount').text(stats.lostItems);
                $('#guestMatchedItemsCount').text(stats.matchedItems);
            },
            error: function () {
                console.error("Failed to load guest stats");
            }
        });
    }

</script>
</body>
</html>